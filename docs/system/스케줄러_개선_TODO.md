# 📋 스케줄러 개선 TODO 리스트

## ✅ 완료된 개선사항 (2025-12-22 기준)

### 1. 스케줄러 구조 및 순서 최적화
- [x] `fetch_and_store_sentiment_for_recommendations()` → `fetch_and_store_sentiment_independent()`로 수정 (AI 의존성 제거)
- [x] 병렬 분석 도입: 기술적 지표와 감정 분석을 동시 실행 (23:05)
- [x] 통합 분석 분리: `_run_combined_analysis()`에서 최종 추천 생성 (23:45)
- [x] Vertex AI 예측(23:00)과 분석 작업 분리

### 2. 공매도 분석 통합
- [x] 공매도 데이터 수집 (daily_stock_data) 및 분석 로직 통합
- [x] 숏 스퀴즈 포착 로직 (공매도 비율 10%↑ + 골든크로스 = 가산점)
- [x] 공매도 과열 종목 위험 회피 (공매도 비율 15%↑ + 하락세 = 감점)

### 3. 기타 개선
- [x] 매도 스케줄러 주기 1분 → 5분으로 변경 (API 부하 감소)
- [x] 중복 매수 방지 로직 활성화

---

## 🚀 예정된 개선사항 (TODO)

### 우선순위 1: 단기 개선 (안정성 & 수익성)
- [x] **매수 시간 조정**: 현재 00:00(장 시작 30분 후) → 23:50(장 시작 20분 후) 변경 완료
- [ ] **포트폴리오 비중 관리**: 단일 종목 최대 투자 비중(예: 20%) 제한 로직 `_execute_auto_buy`에 추가
- [ ] **익절/손절 우선 처리**: 매도 로직에서 익절/손절 조건을 기술적 매도보다 먼저 확실하게 처리하도록 로직 명시화

### 우선순위 2: 중기 개선 (고도화)
- [ ] **트레일링 스톱(Trailing Stop)**: 고정 익절 대신 주가 상승에 따라 익절가를 높이는 로직 구현
- [ ] **시장 상황 모니터링**: VIX 지수나 나스닥 지수 변동성에 따라 매수 금지/비중 축소 로직 추가
- [ ] **성과 추적 대시보드**: 일별 수익률과 추천 정확도를 시각화하는 대시보드용 데이터 구조 설계

### 우선순위 3: 장기 개선 (시스템)
- [ ] **서비스 클래스 리팩토링**: `scheduler.py`에 있는 일부 비즈니스 로직을 각 서비스 클래스로 완전 이관
- [ ] **알림 고도화**: 단순 텍스트 알림을 넘어, 차트 이미지나 더 상세한 분석 리포트 이미지 생성 후 전송

---

**마지막 분석**: 2025-12-22
